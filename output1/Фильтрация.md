
<a name="common-info"></a>

### Общая информация

Функционал фильтрации находится в альфа-версии и пока что доступен ограниченному списку аккаунтов.  
Партнеры amoCRM могут обратиться в техническую поддержку для подключения аккаунта к закрытому тестированию функционала. Заявки на подключение рассматриваются в индивидуальном порядке. 
После успешного тестирования, мы начнем постепенно подключать аккаунты клиентов к данному функционалу.  
Данный функционал доступен для следующих списков: [сделки](https://amocrm.ru/developers/content/crm_platform/leads-api), [контакты](https://amocrm.ru/developers/content/crm_platform/contacts-api), [компании](https://amocrm.ru/developers/content/crm_platform/companies-api) и [покупатели](https://amocrm.ru/developers/content/crm_platform/customers-api).

### Оглавление  
- [Общая информация](#common-info)
- [Фильтрация списка сделок](#leads-filter)
- [Фильтрация списка контактов](#contacts-filter)
- [Фильтрация списка компаний](#companies-filter)
- [Фильтрация списка покупателей](#customers-filter)
- [Типы фильтров](#filter-types)

<a name="leads-filter"></a>

### Фильтрация списка сделок

#### Метод

*GET /api/v4/leads*

#### Описание 

Метод позволяет получить список сделок с учетом переданного фильтра.

#### Ограничения 

Метод доступен в соответствии с правами пользователя.

#### GET параметры 


| Параметр | Тип данных | Описание | Множественный? | Диапазонный? |
|--|--|--|--|--|
| filter | object | Фильтр |  |  |
| filter[id] | int\|array | Фильтр по ID сделок | ✅ | ❌ |
| filter[name] | string\|array | Фильтр по названию сделки | ✅ | ❌ |
| filter[price] | object | Фильтр по бюджету сделки | ❌ | ✅ |
| filter[statuses] | array | Фильтр по статусам сделки | ❌ | ❌ |
| filter[pipeline_id] | int\|array | Фильтр по ID воронок | ✅ | ❌ |
| filter[created_by] | int\|array | Фильтр по ID пользователей, которые создали сущность | ✅ | ❌ |
| filter[updated_by] | int\|array | Фильтр по ID пользователей, которые изменили сущность последними | ✅ | ❌ |
| filter[responsible_user_id] | int\|array | Фильтр по ID пользователей, которые являются ответственными за сущности | ✅ | ❌ |
| filter[created_at] | object | Фильтр по дате создания сделки | ❌ | ✅ |
| filter[updated_at] | object | Фильтр по дате изменения сделки | ❌ | ✅ |
| filter[closed_at] | object | Фильтр по дате закрытия сделки | ❌ | ✅ |
| filter[closest_task_at] | object | Фильтр по дате ближайшей к выполнению задаче | ❌ | ✅ |
| filter[custom_fields_values] | object | Фильтр по значениям дополнительных полей | Зависит от типа поля | Зависит от типа поля |
| query | string | Строка, по которой будет произведен поиск. **В ближайшее время параметр будет признан устаревшим** |  |  |

<a name="contacts-filter"></a>

### Фильтрация списка контактов

#### Метод

*GET /api/v4/contacts*

#### Описание 

Метод позволяет получить список контактов с учетом переданного фильтра.

#### Ограничения 

Метод доступен в соответствии с правами пользователя.

#### GET параметры 


| Параметр | Тип данных | Описание | Множественный? | Диапазонный? |
|--|--|--|--|--|
| filter | object | Фильтр |  |  |
| filter[id] | int\|array | Фильтр по ID контактов | ✅ | ❌ |
| filter[name] | string\|array | Фильтр по названию контакта | ✅ | ❌ |
| filter[created_by] | int\|array | Фильтр по ID пользователей, которые создали сущность | ✅ | ❌ |
| filter[updated_by] | int\|array | Фильтр по ID пользователей, которые изменили сущность последними | ✅ | ❌ |
| filter[responsible_user_id] | int\|array | Фильтр по ID пользователей, которые являются ответственными за сущности | ✅ | ❌ |
| filter[created_at] | object | Фильтр по дате создания контакта | ❌ | ✅ |
| filter[updated_at] | object | Фильтр по дате изменения контакта | ❌ | ✅ |
| filter[closest_task_at] | object | Фильтр по дате ближайшей к выполнению задаче | ❌ | ✅ |
| filter[custom_fields_values] | object | Фильтр по значениям дополнительных полей | Зависит от типа поля | Зависит от типа поля |
| query | string | Строка, по которой будет произведен поиск. **В ближайшее время параметр будет признан устаревшим** |  |  |

<a name="companies-filter"></a>

### Фильтрация списка компаний

#### Метод

*GET /api/v4/companies*

#### Описание 

Метод позволяет получить список компаний с учетом переданного фильтра.

#### Ограничения 

Метод доступен в соответствии с правами пользователя.

#### GET параметры 


| Параметр | Тип данных | Описание | Множественный? | Диапазонный? |
|--|--|--|--|--|
| filter | object | Фильтр |  |  |
| filter[id] | int\|array | Фильтр по ID компаний | ✅ | ❌ |
| filter[name] | string\|array | Фильтр по названию компании | ✅ | ❌ |
| filter[created_by] | int\|array | Фильтр по ID пользователей, которые создали сущность | ✅ | ❌ |
| filter[updated_by] | int\|array | Фильтр по ID пользователей, которые изменили сущность последними | ✅ | ❌ |
| filter[responsible_user_id] | int\|array | Фильтр по ID пользователей, которые являются ответственными за сущности | ✅ | ❌ |
| filter[created_at] | object | Фильтр по дате создания компании | ❌ | ✅ |
| filter[updated_at] | object | Фильтр по дате изменения компании | ❌ | ✅ |
| filter[closest_task_at] | object | Фильтр по дате ближайшей к выполнению задаче | ❌ | ✅ |
| filter[custom_fields_values] | object | Фильтр по значениям дополнительных полей | Зависит от типа поля | Зависит от типа поля |
| query | string | Строка, по которой будет произведен поиск. **В ближайшее время параметр будет признан устаревшим** |  |  |

<a name="customers-filter"></a>

### Фильтрация списка покупателей

#### Метод

*GET /api/v4/customers*

#### Описание 

Метод позволяет получить список покупателей с учетом переданного фильтра.

#### Ограничения 

Метод доступен в соответствии с правами пользователя.

#### GET параметры 


| Параметр | Тип данных | Описание | Множественный? | Диапазонный? |
|--|--|--|--|--|
| filter | object | Фильтр |  |  |
| filter[id] | int\|array | Фильтр по ID покупателей | ✅ | ❌ |
| filter[name] | string\|array | Фильтр по названию покупателя | ✅ | ❌ |
| filter[next_price] | string\|array | Фильтр по ожидаемой сумме следующей покупки | ❌ | ✅ |
| filter[next_date] | object | Фильтр по ожидаемой дате следующей покупки | ❌ | ✅ |
| filter[status_id] | int\|array | Фильтр по ID статуса покупателей | ✅ | ❌ |
| filter[created_by] | int\|array | Фильтр по ID пользователей, которые создали сущность | ✅ | ❌ |
| filter[updated_by] | int\|array | Фильтр по ID пользователей, которые изменили сущность последними | ✅ | ❌ |
| filter[responsible_user_id] | int\|array | Фильтр по ID пользователей, которые являются ответственными за сущности | ✅ | ❌ |
| filter[created_at] | object | Фильтр по дате создания компании | ❌ | ✅ |
| filter[updated_at] | object | Фильтр по дате изменения компании | ❌ | ✅ |
| filter[closest_task_at] | object | Фильтр по дате ближайшей к выполнению задаче | ❌ | ✅ |
| filter[custom_fields_values] | object | Фильтр по значениям дополнительных полей | Зависит от типа поля | Зависит от типа поля |

<a name="filter-types"></a>

### Типы фильтров

В данный момент доступно несколько типов фильтров.

-   Одиночный
-   Множественный
-   Диапазонный
-   Фильтр по статусам (только для сделок)
-   Фильтр по дополнительным полям

Каждый из них рассмотрим ниже с примерами.

#### Одиночный

Самый простой фильтр, который доступен. Принимает одно строковое
значение.

Пример запроса

```
        
    /api/v4/leads/?filter[name]=Сделка
        
```

#### Множественный

Расширенный вариант одиночного фильтра. Принимает несколько строковых
значений.

Пример запроса

```
       
    /api/v4/leads/?filter[pipeline_id][0]=15314&filter[pipeline_id][0]=21856
            
```

#### Диапазонный

Фильтр, который позволяет фильтровать числовые значение по диапазону
ОТ-ДО.

Если фильтр установлен по значением полей, в которых хранится timestamp,
то необходимо передавать в фильтр timestamp значения.

Фильтр доступен для следующих полей:

-   price
-   next\_price
-   next\_date
-   created\_at
-   updated\_at
-   closed\_at
-   closest\_task\_at
-   Поля типа date, date\_time, numeric

Пример запроса

```
      
    /api/v4/leads/?filter[updated_at][from]=1575296400&filter[updated_at][to]=1589540009
            
```

#### Фильтр по статусам

Фильтр, который позволяет фильтровать сделки по нахождению в конкретных
статусах.

Фильтр принимает массив, у каждого объекта массива есть 2 обязательных
поля - pipeline\_id и status\_id.

Пример запроса

```
       
    /api/v4/leads?filter[statuses][0][pipeline_id]={pipeline_id}&filter[statuses][0][status_id]={status_id}
            
```

#### Фильтр по дополнительным полям

Фильтр, который позволяет фильтровать сделки по значению нескольких
дополнительных полей.

Для разных типов полей необходимы разные значения в фильтре.

-   Для полей numeric, text, url, textarea, streetaddress в значение
    фильтра передается значение поля
-   Для полей select, multiselect, radiobutton в значение фильтра
    передается ID enum значения
-   Для поля checkbox в значение фильтра передается 1 или 0

Для разных типов полей доступны разные подходы к фильтрации.

Поля, которые поддерживают фильтр по диапазону:

-   date
-   date\_time
-   numeric

Поля, которые поддерживают множественный выбор:

-   numeric
-   text
-   url
-   textarea
-   streetaddress
-   select
-   multiselect
-   radiobutton

Пример запроса

```
      
    /api/v4/leads?filter[custom_fields_values][{field_id}][]={value}&filter[custom_fields_values][{field_id}][]={value2}
    /api/v4/leads?filter[custom_fields_values][{field_id}][]={enum_id}&filter[custom_fields_values][{field_id}][]={enum_id2}
    /api/v4/leads?filter[custom_fields_values][{field_id}][from]={date_from}&filter[custom_fields_values][{field_id}][to]={date_to}
            
```

<!-- Generated at Thu, 04 Mar 2021 09:23:30 +0000. amoCRM Documentation Generator -->